#!/bin/bash
# {{ ansible_managed}}

target="$1"
if [[ -z "$target" ]]; then
  echo "$0 TARGET_FILE"
  exit 1
fi

echo "Enter the password for the \"{{ chiton_db_root_name }}\" Postgres user"
pg_dump --format=c --host="{{ chiton_db_host }}" --port="{{ chiton_db_port }}" --username="{{ chiton_db_root_name }}" --dbname="{{ chiton_db_name }}" > "$target"
echo "A full database backup was created at \"$target\""
